<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" >
<head>
	<th:block th:include="include :: header('新增借款申请')" />
</head>
<body class="white-bg">
<div class="wrapper wrapper-content animated fadeInRight ibox-content">
	<form class="form-horizontal m" id="form-facLoanApply-add">
		<div class="form-group">
			<label class="col-sm-3 control-label">借款名称：</label>
			<div class="col-sm-8">
				<input id="loanName" name="loanName" class="form-control" type="text" required>
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-3 control-label">借款金额：</label>
			<div class="col-sm-8">
				<input id="amount" name="amount" class="form-control" type="text" required>
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-3 control-label">借款时间：</label>
			<div class="col-sm-8">
				<input id="loanTime" name="loanTime" class="form-control" type="date" required>
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-3 control-label">预计还款时间：</label>
			<div class="col-sm-8">
				<input id="repayTime" name="repayTime" class="form-control" type="date" required>
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-3 control-label">借款事由：</label>
			<div class="col-sm-8">
				<input id="reason" name="reason" class="form-control" type="text" required>
			</div>
		</div>
	</form>
	<form class="form-horizontal m" id="form-facUserApproval-edit" th:object="${facUserApproval}">
		<div class="row">
			<div class="col-sm-6">
				<div class="form-group" id="div-reiadd">
					<label class="col-sm-4 control-label"></span>审批意见：</label>
					<div class="col-sm-8">
						<input id="opi" name="opi" class="form-control" type="text">
						<input id="applyId" name="applyId" class="form-control-static" type="hidden" th:value="${num}">
						<input id="approverId" name="approverId" class="form-control-static" type="hidden"
							   th:value="${userId}">
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-sm-offset-5 col-sm-10">
				<button type="button" class="btn btn-sm btn-primary" onclick="submitHandler(1)"><i
						class="fa fa-check"></i>同意
				</button>&nbsp;
				<button type="button" class="btn btn-sm btn-primary" onclick="submitHandler(2)"><i
						class="fa fa-check"></i>驳回
				</button>&nbsp;
				<button type="button" class="btn btn-sm btn-danger" onclick="closeItem()"><i
						class="fa fa-reply-all"></i>关 闭
				</button>
			</div>
		</div>

	</form>
</div>
<div th:include="include::footer"></div>
<script type="text/javascript">
	var prefix = ctx + "system/facLoanApply"
	$("#form-facLoanApply-add").validate({
		rules:{
			xxxx:{
				required:true,
			},
		},
		focusCleanup: true
	});



	function mSave(url, data, callback) {
		var config = {
			url: url,
			type: "post",
			dataType: "json",
			data: data,
			beforeSend: function () {
				$.modal.loading("正在处理中，请稍后...");
				$.modal.disable();
			},
			success: function (result) {
				if (typeof callback == "function") {
					callback(result);
				}
				$.modal.closeLoading();
				$.modal.enable();
				alert(result.msg);
				$.modal.closeTab();
			}
		};
		$.ajax(config)
	}

	function submitHandler(index) {
		if ($.validate.form()) {
			//index为1表示同意
			if (index == 1) {
				mSave(prefixs + "/edit", $('#form-facUserApproval-edit').serialize());
			} else {
				mSave(prefixs + "/editnot", $('#form-facUserApproval-edit').serialize());
			}
		}
	}
</script>
</body>
</html>
