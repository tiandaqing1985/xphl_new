<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.DangdangPzBackMapper">
    
    <resultMap type="DangdangPzBack" id="DangdangPzBackResult">
        <result property="id"    column="id"    />
        <result property="ddDate"    column="dd_date"    />
        <result property="uv"    column="uv"    />
    </resultMap>
	
	<sql id="selectDangdangPzBackVo">
        select id, dd_date, uv from dangdang_pz_back
    </sql>
	
    <select id="selectDangdangPzBackList" parameterType="DangdangPzBack" resultMap="DangdangPzBackResult">
        <include refid="selectDangdangPzBackVo"/>
        <where>  
            <if test="id != null "> and id = #{id}</if>
             <if test="ddDate != null "> and dd_date = #{ddDate}</if>
             <if test="uv != null "> and uv = #{uv}</if>
         </where>
    </select>
    
    <select id="selectDangdangPzBackById" parameterType="Integer" resultMap="DangdangPzBackResult">
        <include refid="selectDangdangPzBackVo"/>
        where id = #{id}
    </select>
    <select id="importPz" resultType="com.ruoyi.system.domain.DangdangPzBack">
        SELECT dd_date as ddDate,sum(uv) as uv FROM dangdang_pz_back GROUP BY dd_date having 1=1   <if test="ddDate != null  "> and dd_date=#{ddDate},</if>
    </select>

    <insert id="insertDangdangPzBack" parameterType="DangdangPzBack" useGeneratedKeys="true" keyProperty="id">
        insert into dangdang_pz_back
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="ddDate != null  ">dd_date,</if>
			<if test="uv != null  ">uv,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="ddDate != null  ">#{ddDate},</if>
			<if test="uv != null  ">#{uv},</if>
         </trim>
    </insert>
	 
    <update id="updateDangdangPzBack" parameterType="DangdangPzBack">
        update dangdang_pz_back
        <trim prefix="SET" suffixOverrides=",">
            <if test="ddDate != null  ">dd_date = #{ddDate},</if>
            <if test="uv != null  ">uv = #{uv},</if>
        </trim>
        where id = #{id}
    </update>

	<delete id="deleteDangdangPzBackById" parameterType="Integer">
        delete from dangdang_pz_back where id = #{id}
    </delete>
	
    <delete id="deleteDangdangPzBackByIds" parameterType="String">
        delete from dangdang_pz_back where id in 
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>
    <insert id="batchInsert"  parameterType="java.util.List" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO dangdang_pz_back (dd_date,uv)
        VALUES
        <foreach collection="list" item="item" separator=",">
            (#{item.ddDate}, #{item.uv})
        </foreach>
    </insert>
</mapper>